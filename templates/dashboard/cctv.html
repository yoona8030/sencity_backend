{% extends "dashboard/base.html" %} {% load static %} {% block title %}CCTV 관리{% endblock %} {% block extra_head %}
<link rel="stylesheet" href="{% static 'dashboard/css/cctv.css' %}?v=2025-11-06" />
<script defer src="{% static 'dashboard/js/cctv.js' %}?v=2025-11-24"></script>

<!-- JS에서 필요시 사용할 수 있도록 CSRF 토큰 메타 노출 -->
<meta name="csrf-token" content="{{ csrf_token }}" />
{% endblock %} {% block content %}
<div class="dashboard-body wrap page-cctv">
  <h1 class="page-title">CCTV 관리</h1>

  <section class="cctv-grid">
    <!-- 좌측 패널 -->
    <aside class="left-col">
      <article class="card devices-card">
        <h2 class="card-title">CCTV 디바이스 현황</h2>
        <ul id="device-list" class="device-list">
          <!-- JS 렌더 -->
        </ul>
      </article>

      <article class="card sensors-card">
        <h2 class="card-title">모션 센서</h2>
        <div id="sensor-grid" class="sensor-grid"><!-- JS 렌더 --></div>
      </article>
    </aside>

    <!-- 우측: 메인 뷰어 -->
    <div class="right-col">
      <article class="card viewer-card">
        <div class="viewer-head">
          <span class="viewer-title" id="viewer-title">실시간 영상</span>

          <div class="cam-tabs" role="tablist" aria-label="카메라 전환">
            <button class="cam-tab is-active" data-cam="1" aria-selected="true">1</button>
            <button class="cam-tab" data-cam="2">2</button>
            <button class="cam-tab" data-cam="3">3</button>
            <button class="cam-tab" data-cam="4">4</button>
          </div>

          <div class="cam-source-toggle">
            <button class="src-btn is-active" data-src="webcam">노트북 캠</button>
            <button class="src-btn" data-src="cctv">외부 캠</button>
          </div>
        </div>

        <div class="viewer-body">
          <!-- 단순 뷰어: 이미지 / 비디오 데모만 사용 -->
          <img id="viewer-img" class="viewer-media" alt="카메라 1" />
          <video id="viewer-video" class="viewer-media" autoplay muted loop playsinline controls style="display: none">
            <source id="viewer-source" src="{% static 'dashboard/videos/sample1.mp4' %}" type="video/mp4" />
          </video>

          <!-- ✅ YOLO 박스 오버레이 -->
          <div id="yolo-overlay" class="viewer-overlay"></div>
        </div>

        <div class="viewer-foot" id="viewer-foot">카메라 1</div>
      </article>
    </div>
  </section>
</div>
{% endblock %}
