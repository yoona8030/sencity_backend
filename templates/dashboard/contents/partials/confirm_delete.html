{# 모달 오버레이 - body 끝에 append되는 조각 #}
<div id="content-delete-modal-{{ id }}" class="confirm-mask" style="
  position: fixed; inset: 0; z-index: 10000;
  display:flex; align-items:center; justify-content:center;
  background: rgba(0,0,0,.45);
">
  <div style="
    width:min(520px, 92vw);
    background:#fff; border-radius:14px; box-shadow:0 10px 40px rgba(0,0,0,.18);
    overflow:hidden;
  ">
    <div style="padding:14px 16px; border-bottom:1px solid #eee; display:flex; align-items:center; justify-content:space-between">
      <strong>항목 삭제</strong>
      <button class="btn"
              hx-get="{% url 'dashboard:content_close_confirm' pk=id %}"
              hx-target="#content-delete-modal-{{ id }}"
              hx-swap="outerHTML">닫기</button>
    </div>

    <div style="padding:16px;">
      <p style="margin:0 0 6px 0;">이 항목을 정말 삭제할까요?</p>
      <small style="color:#555;">삭제 후 되돌릴 수 없습니다.</small>
    </div>

    <div style="padding:12px 16px; border-top:1px solid #eee; display:flex; gap:8px; justify-content:flex-end">
      {# ✅ 삭제 실행: 행 제거 + 목록 새로고침 + 모달 닫기 #}
      <button class="btn warn"
              hx-post="{% url 'dashboard:content_delete' pk=id %}"
              hx-vals='{"_method":"DELETE"}'
              hx-target="#row-{{ id }}"     {# 최근 리스트의 행을 바로 지움(해당 행에 id="row-{{id}}" 있어야 함) #}
              hx-swap="delete"
              hx-on::after-request="
                htmx.trigger(document.body, 'recent:refresh');
                document.getElementById('content-delete-modal-{{ id }}')?.remove();
              ">
        예, 삭제합니다
      </button>

      <button class="btn"
              hx-get="{% url 'dashboard:content_close_confirm' pk=id %}"
              hx-target="#content-delete-modal-{{ id }}"
              hx-swap="outerHTML">취소</button>
    </div>
  </div>
</div>

<script>
  // ESC/배경 클릭으로 닫기(선택)
  (function(el){
    if(!el) return;
    function onKey(e){ if(e.key==='Escape'){ el.remove(); document.removeEventListener('keydown', onKey);} }
    document.addEventListener('keydown', onKey);
    el.addEventListener('click', function(ev){ if(ev.target===el){ el.remove(); }});
  })(document.getElementById('content-delete-modal-{{ id }}'));
</script>
